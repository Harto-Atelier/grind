<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trading | Nuria</title>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #1e1e1e;
            --card: #252526;
            --sidebar: #181818;
            --primary: #007acc;
            --cyan: #4ec9b0;
            --cyan-dim: rgba(78, 201, 176, 0.15);
            --cyan-border: rgba(78, 201, 176, 0.4);
            --orange: #FF6B00;
            --green: #00FF88;
            --red: #f14c4c;
            --yellow: #dcdcaa;
            --purple: #c586c0;
            --text: #d4d4d4;
            --muted: #808080;
            --border: #3c3c3c;
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg);
            color: var(--text);
            min-height: 100vh;
        }
        
        .mono { font-family: 'JetBrains Mono', monospace; }
        
        /* Navigation */
        .nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 40px;
            border-bottom: 1px solid var(--border);
            position: sticky;
            top: 0;
            background: var(--bg);
            z-index: 100;
        }
        .nav-brand {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            color: var(--cyan);
            letter-spacing: 2px;
        }
        .nav-links { display: flex; gap: 30px; }
        .nav-links a {
            color: var(--muted);
            text-decoration: none;
            font-size: 0.85rem;
            transition: color 0.2s;
        }
        .nav-links a:hover, .nav-links a.active { color: var(--cyan); }
        
        /* Page Header */
        .page-header {
            padding: 40px;
            border-bottom: 1px solid var(--border);
        }
        .page-title {
            font-family: 'JetBrains Mono', monospace;
            font-size: 2rem;
            font-weight: 700;
            letter-spacing: 4px;
            margin-bottom: 10px;
        }
        .page-subtitle {
            color: var(--muted);
            font-size: 0.9rem;
        }
        
        /* Main Content */
        .main-content {
            padding: 40px;
        }
        
        /* Section */
        .section {
            margin-bottom: 40px;
        }
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        .section-title {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            color: var(--cyan);
            letter-spacing: 2px;
        }
        .section-link {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.75rem;
            color: var(--muted);
            text-decoration: none;
        }
        .section-link:hover { color: var(--cyan); }
        
        /* Price Ticker */
        .ticker-bar {
            display: flex;
            gap: 30px;
            padding: 15px 40px;
            background: var(--card);
            border-bottom: 1px solid var(--border);
            overflow-x: auto;
        }
        .ticker-item {
            display: flex;
            align-items: center;
            gap: 10px;
            white-space: nowrap;
        }
        .ticker-label {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.75rem;
            color: var(--muted);
        }
        .ticker-value {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--text);
        }
        .ticker-change {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.75rem;
        }
        .ticker-change.positive { color: var(--green); }
        .ticker-change.negative { color: var(--red); }
        
        /* Widget Grid */
        .widget-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }
        .widget-grid.full {
            grid-template-columns: 1fr;
        }
        
        /* Widget Card */
        .widget {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 25px;
        }
        .widget-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        .widget-title {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            color: var(--cyan);
            letter-spacing: 1px;
        }
        .widget-link {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.7rem;
            color: var(--muted);
            text-decoration: none;
            padding: 5px 10px;
            border: 1px solid var(--border);
            border-radius: 4px;
            transition: all 0.2s;
        }
        .widget-link:hover {
            color: var(--cyan);
            border-color: var(--cyan);
        }
        
        /* TIBBIR Widget */
        .tibbir-widget {
            background: linear-gradient(135deg, rgba(251, 191, 36, 0.1), rgba(255, 107, 0, 0.05));
            border-color: rgba(251, 191, 36, 0.3);
        }
        .tibbir-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 25px;
        }
        .tibbir-logo { font-size: 3rem; }
        .tibbir-info h3 {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.5rem;
            color: var(--yellow);
            letter-spacing: 2px;
        }
        .tibbir-info span {
            font-size: 0.8rem;
            color: var(--muted);
        }
        .tibbir-stats {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-bottom: 25px;
        }
        .tibbir-stat {
            text-align: center;
            padding: 15px;
            background: rgba(0,0,0,0.3);
            border-radius: 8px;
        }
        .tibbir-stat-value {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--yellow);
        }
        .tibbir-stat-value.positive { color: var(--green); }
        .tibbir-stat-value.negative { color: var(--red); }
        .tibbir-stat-label {
            font-size: 0.7rem;
            color: var(--muted);
            text-transform: uppercase;
            margin-top: 5px;
        }
        .tibbir-buttons {
            display: flex;
            gap: 10px;
        }
        .tibbir-btn {
            flex: 1;
            display: block;
            background: linear-gradient(90deg, var(--yellow), var(--orange));
            border: none;
            color: #000;
            padding: 12px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.75rem;
            font-weight: 600;
            text-align: center;
            text-decoration: none;
            border-radius: 6px;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .tibbir-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(251, 191, 36, 0.3);
        }
        .tibbir-btn.purple {
            background: linear-gradient(135deg, #a855f7, #6366f1);
            color: #fff;
        }
        
        /* Marketplace Widget */
        .marketplace-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }
        .marketplace-stat {
            text-align: center;
            padding: 15px;
            background: rgba(0,0,0,0.2);
            border-radius: 8px;
        }
        .marketplace-stat-value {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--cyan);
        }
        .marketplace-stat-label {
            font-size: 0.7rem;
            color: var(--muted);
            text-transform: uppercase;
            margin-top: 5px;
        }
        .collection-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        .collection-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 15px;
            background: rgba(0,0,0,0.2);
            border-radius: 6px;
            transition: background 0.2s;
        }
        .collection-item:hover {
            background: rgba(0,0,0,0.3);
        }
        .collection-name {
            font-size: 0.85rem;
        }
        .collection-floor {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            color: var(--cyan);
            font-weight: 600;
        }
        
        /* Portfolio Grid */
        .portfolio-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        .portfolio-total {
            font-family: 'JetBrains Mono', monospace;
        }
        .portfolio-total-btc {
            font-size: 1.2rem;
            color: var(--cyan);
            font-weight: 600;
        }
        .portfolio-total-usd {
            font-size: 1rem;
            color: var(--green);
            margin-left: 15px;
        }
        .portfolio-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
        }
        .portfolio-card {
            background: rgba(0,0,0,0.2);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 15px;
            transition: all 0.2s;
        }
        .portfolio-card:hover {
            border-color: var(--cyan-border);
            background: var(--cyan-dim);
        }
        .portfolio-card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 10px;
        }
        .portfolio-collection-name {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.8rem;
            color: var(--text);
            font-weight: 600;
        }
        .portfolio-supply {
            font-size: 0.7rem;
            color: var(--muted);
            margin-top: 3px;
        }
        .portfolio-change {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.7rem;
            padding: 2px 6px;
            border-radius: 3px;
        }
        .portfolio-change.positive {
            background: rgba(0, 255, 136, 0.15);
            color: var(--green);
        }
        .portfolio-change.negative {
            background: rgba(241, 76, 76, 0.15);
            color: var(--red);
        }
        .portfolio-floor {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1rem;
            color: var(--cyan);
            font-weight: 600;
        }
        .portfolio-usd {
            font-size: 0.75rem;
            color: var(--muted);
            margin-top: 3px;
        }
        .portfolio-loading {
            text-align: center;
            padding: 40px;
            color: var(--muted);
        }
        .portfolio-update {
            text-align: center;
            margin-top: 20px;
            font-size: 0.75rem;
            color: var(--muted);
        }
        
        /* Tools Grid */
        .tools-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
        }
        .tool-card {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            text-decoration: none;
            transition: all 0.2s;
        }
        .tool-card:hover {
            border-color: var(--cyan);
            transform: translateY(-3px);
        }
        .tool-icon { font-size: 2rem; margin-bottom: 10px; }
        .tool-name {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.8rem;
            color: var(--text);
            letter-spacing: 1px;
        }
        .tool-desc {
            font-size: 0.7rem;
            color: var(--muted);
            margin-top: 5px;
        }
        
        /* Error State */
        .error-state {
            text-align: center;
            padding: 30px;
            color: var(--red);
        }
        
        /* Responsive */
        @media (max-width: 1200px) {
            .portfolio-grid { grid-template-columns: repeat(3, 1fr); }
            .tools-grid { grid-template-columns: repeat(2, 1fr); }
        }
        @media (max-width: 768px) {
            .nav { padding: 15px 20px; }
            .nav-links { gap: 15px; }
            .page-header, .main-content { padding: 20px; }
            .widget-grid { grid-template-columns: 1fr; }
            .tibbir-stats { grid-template-columns: repeat(2, 1fr); }
            .marketplace-stats { grid-template-columns: repeat(2, 1fr); }
            .portfolio-grid { grid-template-columns: repeat(2, 1fr); }
            .tools-grid { grid-template-columns: 1fr; }
            .ticker-bar { padding: 10px 20px; gap: 20px; }
        }
        
        /* Samsung S24 Ultra & Premium Mobile */
        @media (max-width: 480px) {
            .nav { padding: 12px 16px; position: sticky; top: 0; backdrop-filter: blur(10px); }
            .nav-brand { font-size: 0.7rem; letter-spacing: 1px; }
            .nav-links { gap: 10px; overflow-x: auto; }
            .nav-links a { font-size: 0.75rem; padding: 6px 2px; white-space: nowrap; }
            
            .ticker-bar { padding: 8px 16px; gap: 12px; }
            .ticker-label { font-size: 0.65rem; }
            .ticker-value { font-size: 0.75rem; }
            .ticker-change { font-size: 0.65rem; }
            
            .page-header { padding: 20px 16px; }
            .page-title { font-size: 1.5rem; letter-spacing: 2px; }
            .page-subtitle { font-size: 0.8rem; }
            
            .main-content { padding: 16px; }
            .section { margin-bottom: 24px; }
            .section-title { font-size: 0.8rem; }
            
            .widget { padding: 16px; }
            .widget-title { font-size: 0.75rem; }
            
            /* TIBBIR */
            .tibbir-header { gap: 12px; margin-bottom: 16px; }
            .tibbir-logo { font-size: 2.5rem; }
            .tibbir-info h3 { font-size: 1.2rem; }
            .tibbir-stats { gap: 8px; margin-bottom: 16px; }
            .tibbir-stat { padding: 10px 8px; }
            .tibbir-stat-value { font-size: 1rem; }
            .tibbir-stat-label { font-size: 0.6rem; }
            .tibbir-buttons { gap: 8px; }
            .tibbir-btn { padding: 10px; font-size: 0.7rem; }
            
            /* Marketplace */
            .marketplace-stats { gap: 8px; }
            .marketplace-stat { padding: 12px 8px; }
            .marketplace-stat-value { font-size: 1.1rem; }
            .collection-item { padding: 10px 12px; }
            .collection-name { font-size: 0.8rem; }
            .collection-floor { font-size: 0.8rem; }
            
            /* Portfolio */
            .portfolio-header { flex-direction: column; gap: 10px; align-items: flex-start; }
            .portfolio-total { font-size: 0.85rem; }
            .portfolio-grid { grid-template-columns: 1fr 1fr; gap: 10px; }
            .portfolio-card { padding: 12px; }
            .portfolio-collection-name { font-size: 0.75rem; }
            .portfolio-floor { font-size: 0.9rem; }
            .portfolio-usd { font-size: 0.7rem; }
            
            /* Tools */
            .tools-grid { grid-template-columns: 1fr 1fr; gap: 10px; }
            .tool-card { padding: 16px 12px; }
            .tool-icon { font-size: 1.5rem; margin-bottom: 8px; }
            .tool-name { font-size: 0.7rem; }
            .tool-desc { font-size: 0.65rem; }
            
            body { padding-bottom: env(safe-area-inset-bottom, 20px); }
        }
    </style>
</head>
<body>
    <nav class="nav">
        <div class="nav-brand">HARTO // COMMAND CENTER</div>
        <div class="nav-links">
            <a href="index.html">Dashboard</a>
            <a href="tasks.html">Tasks</a>
            <a href="trading.html" class="active">Trading</a>
            <a href="team.html">Team</a>
            <a href="crm.html">CRM</a>
        </div>
    </nav>
    
    <!-- Price Ticker -->
    <div class="ticker-bar">
        <div class="ticker-item">
            <span class="ticker-label">BTC</span>
            <span class="ticker-value" id="tickerBtc">$--</span>
            <span class="ticker-change" id="tickerBtcChange">--%</span>
        </div>
        <div class="ticker-item">
            <span class="ticker-label">ETH</span>
            <span class="ticker-value" id="tickerEth">$--</span>
            <span class="ticker-change" id="tickerEthChange">--%</span>
        </div>
        <div class="ticker-item">
            <span class="ticker-label">TIBBIR</span>
            <span class="ticker-value" id="tickerTibbir">$--</span>
            <span class="ticker-change" id="tickerTibbirChange">--%</span>
        </div>
        <div class="ticker-item">
            <span class="ticker-label">BLOCK</span>
            <span class="ticker-value" id="tickerBlock">#--</span>
        </div>
        <div class="ticker-item">
            <span class="ticker-label">FEE</span>
            <span class="ticker-value" id="tickerFee">-- sat/vB</span>
        </div>
    </div>
    
    <header class="page-header">
        <h1 class="page-title">TRADING</h1>
        <p class="page-subtitle">Portfolio tracking, market data, and trading tools</p>
    </header>
    
    <main class="main-content">
        <!-- TIBBIR + Marketplace -->
        <div class="widget-grid">
            <!-- TIBBIR Widget -->
            <div class="widget tibbir-widget">
                <div class="tibbir-header">
                    <div class="tibbir-logo">üê∏</div>
                    <div class="tibbir-info">
                        <h3>$TIBBIR</h3>
                        <span>Ribbita by Virtuals ‚Ä¢ Base Chain</span>
                    </div>
                </div>
                <div class="tibbir-stats">
                    <div class="tibbir-stat">
                        <div class="tibbir-stat-value" id="tibbirPrice">$--</div>
                        <div class="tibbir-stat-label">Price</div>
                    </div>
                    <div class="tibbir-stat">
                        <div class="tibbir-stat-value" id="tibbirMcap">$--</div>
                        <div class="tibbir-stat-label">Market Cap</div>
                    </div>
                    <div class="tibbir-stat">
                        <div class="tibbir-stat-value" id="tibbirChange">--%</div>
                        <div class="tibbir-stat-label">24h Change</div>
                    </div>
                    <div class="tibbir-stat">
                        <div class="tibbir-stat-value" id="tibbirVolume">$--</div>
                        <div class="tibbir-stat-label">24h Volume</div>
                    </div>
                </div>
                <div class="tibbir-buttons">
                    <a href="https://dexscreener.com/base/0x0c3b466104545efa096b8f944c1e524e1d0d4888" target="_blank" class="tibbir-btn">üìä DEXSCREENER</a>
                    <a href="https://bubblemaps.io/base/token/0xA4A2E2ca3fBfE21aed83471D28b6f65A233C6e00" target="_blank" class="tibbir-btn purple">üó∫Ô∏è BUBBLES</a>
                </div>
            </div>
            
            <!-- Marketplace Widget -->
            <div class="widget">
                <div class="widget-header">
                    <div class="widget-title">üñºÔ∏è ORDINALS MARKET</div>
                    <a href="https://ordinals-market.vercel.app" target="_blank" class="widget-link">OPEN ‚Üí</a>
                </div>
                <div class="marketplace-stats">
                    <div class="marketplace-stat">
                        <div class="marketplace-stat-value" id="marketCollections">--</div>
                        <div class="marketplace-stat-label">Collections</div>
                    </div>
                    <div class="marketplace-stat">
                        <div class="marketplace-stat-value" id="marketVolume">-- BTC</div>
                        <div class="marketplace-stat-label">24h Volume</div>
                    </div>
                    <div class="marketplace-stat">
                        <div class="marketplace-stat-value" id="marketListings">--</div>
                        <div class="marketplace-stat-label">Listings</div>
                    </div>
                </div>
                <div class="collection-list" id="topCollections">
                    <div class="collection-item">
                        <span class="collection-name">Loading...</span>
                        <span class="collection-floor">--</span>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Harto Portfolio -->
        <section class="section">
            <div class="section-header">
                <div class="section-title">// HARTO PORTFOLIO</div>
            </div>
            <div class="widget" style="background: linear-gradient(135deg, rgba(0, 122, 204, 0.08), rgba(78, 201, 176, 0.05)); border-color: var(--cyan-border);">
                <div class="portfolio-header">
                    <div class="widget-title">Floor Prices by Collection</div>
                    <div class="portfolio-total">
                        Total: <span class="portfolio-total-btc" id="portfolioTotalBtc">-- BTC</span>
                        <span class="portfolio-total-usd" id="portfolioTotalUsd">$--</span>
                    </div>
                </div>
                <div class="portfolio-grid" id="portfolioGrid">
                    <div class="portfolio-loading">Loading portfolio data...</div>
                </div>
                <div class="portfolio-update">
                    <span id="portfolioLastUpdate">Updating...</span>
                </div>
            </div>
        </section>
        
        <!-- Trading Tools -->
        <section class="section">
            <div class="section-header">
                <div class="section-title">// TOOLS</div>
            </div>
            <div class="tools-grid">
                <a href="sat-mining.html" class="tool-card">
                    <div class="tool-icon">‚õèÔ∏è</div>
                    <div class="tool-name">SAT MINING</div>
                    <div class="tool-desc">Find rare sats by block</div>
                </a>
                <a href="sats-arbitrage.html" class="tool-card">
                    <div class="tool-icon">üíé</div>
                    <div class="tool-name">ARBITRAGE</div>
                    <div class="tool-desc">Scan for underpriced sats</div>
                </a>
                <a href="https://ordinals-market.vercel.app" target="_blank" class="tool-card">
                    <div class="tool-icon">üñºÔ∏è</div>
                    <div class="tool-name">MARKETPLACE</div>
                    <div class="tool-desc">Browse & trade Ordinals</div>
                </a>
                <a href="https://magiceden.io/ordinals" target="_blank" class="tool-card">
                    <div class="tool-icon">ü™Ñ</div>
                    <div class="tool-name">MAGIC EDEN</div>
                    <div class="tool-desc">External marketplace</div>
                </a>
            </div>
        </section>
    </main>
    
    <script>
        // üìä Ticker Data
        async function loadTickerData() {
            try {
                // BTC and ETH from CoinGecko
                const priceRes = await fetch('https://api.coingecko.com/api/v3/simple/price?ids=bitcoin,ethereum&vs_currencies=usd&include_24hr_change=true');
                if (priceRes.ok) {
                    const prices = await priceRes.json();
                    
                    if (prices.bitcoin) {
                        document.getElementById('tickerBtc').textContent = `$${prices.bitcoin.usd.toLocaleString()}`;
                        const btcChange = prices.bitcoin.usd_24h_change || 0;
                        const btcEl = document.getElementById('tickerBtcChange');
                        btcEl.textContent = `${btcChange > 0 ? '+' : ''}${btcChange.toFixed(1)}%`;
                        btcEl.className = 'ticker-change ' + (btcChange >= 0 ? 'positive' : 'negative');
                    }
                    
                    if (prices.ethereum) {
                        document.getElementById('tickerEth').textContent = `$${prices.ethereum.usd.toLocaleString()}`;
                        const ethChange = prices.ethereum.usd_24h_change || 0;
                        const ethEl = document.getElementById('tickerEthChange');
                        ethEl.textContent = `${ethChange > 0 ? '+' : ''}${ethChange.toFixed(1)}%`;
                        ethEl.className = 'ticker-change ' + (ethChange >= 0 ? 'positive' : 'negative');
                    }
                }
                
                // Block height and fees
                const [blockRes, feeRes] = await Promise.all([
                    fetch('https://mempool.space/api/blocks/tip/height'),
                    fetch('https://mempool.space/api/v1/fees/recommended')
                ]);
                
                if (blockRes.ok) {
                    const height = await blockRes.text();
                    document.getElementById('tickerBlock').textContent = `#${parseInt(height).toLocaleString()}`;
                }
                
                if (feeRes.ok) {
                    const fees = await feeRes.json();
                    document.getElementById('tickerFee').textContent = `${fees.fastestFee} sat/vB`;
                }
            } catch (e) {
                console.error('Ticker load failed:', e);
            }
        }
        
        // üê∏ TIBBIR Data
        async function loadTibbirData() {
            try {
                const res = await fetch('https://api.dexscreener.com/latest/dex/pairs/base/0x0c3b466104545efa096b8f944c1e524e1d0d4888');
                if (!res.ok) throw new Error('Failed to fetch TIBBIR');
                
                const data = await res.json();
                const pair = data.pair;
                
                if (pair) {
                    const price = parseFloat(pair.priceUsd);
                    const mcap = pair.marketCap || pair.fdv || 0;
                    const change = pair.priceChange?.h24 || 0;
                    const volume = pair.volume?.h24 || 0;
                    
                    document.getElementById('tibbirPrice').textContent = `$${price.toFixed(4)}`;
                    document.getElementById('tibbirMcap').textContent = mcap > 1000000 
                        ? `$${(mcap / 1000000).toFixed(1)}M` 
                        : `$${(mcap / 1000).toFixed(0)}K`;
                    document.getElementById('tibbirVolume').textContent = volume > 1000000
                        ? `$${(volume / 1000000).toFixed(1)}M`
                        : `$${(volume / 1000).toFixed(0)}K`;
                    
                    const changeEl = document.getElementById('tibbirChange');
                    changeEl.textContent = `${change > 0 ? '+' : ''}${parseFloat(change).toFixed(1)}%`;
                    changeEl.className = 'tibbir-stat-value ' + (change >= 0 ? 'positive' : 'negative');
                    
                    // Ticker
                    document.getElementById('tickerTibbir').textContent = `$${price.toFixed(3)}`;
                    const tickerEl = document.getElementById('tickerTibbirChange');
                    tickerEl.textContent = `${change > 0 ? '+' : ''}${parseFloat(change).toFixed(0)}%`;
                    tickerEl.className = 'ticker-change ' + (change >= 0 ? 'positive' : 'negative');
                }
            } catch (e) {
                console.error('TIBBIR load failed:', e);
                document.getElementById('tibbirPrice').textContent = 'Error';
            }
        }
        
        // üñºÔ∏è Marketplace Data
        async function loadMarketplaceData() {
            try {
                const res = await fetch('data/marketplace.json?t=' + Date.now());
                if (!res.ok) throw new Error('Failed to load marketplace');
                
                const data = await res.json();
                
                document.getElementById('marketCollections').textContent = data.stats?.collections || '12';
                document.getElementById('marketVolume').textContent = (data.stats?.volume24h || 2.4).toFixed(1) + ' BTC';
                document.getElementById('marketListings').textContent = data.stats?.listings || '1.2K';
                
                const container = document.getElementById('topCollections');
                const collections = data.topCollections || [
                    { emoji: 'üüß', name: 'Bitcoin Puppets', floor: 0.15 },
                    { emoji: 'üê±', name: 'OMB', floor: 0.08 },
                    { emoji: 'üé®', name: 'NodeMonkes', floor: 0.12 }
                ];
                
                container.innerHTML = collections.slice(0, 5).map(c => `
                    <div class="collection-item">
                        <span class="collection-name">${c.emoji || 'üñºÔ∏è'} ${c.name}</span>
                        <span class="collection-floor">${c.floor.toFixed(3)} BTC</span>
                    </div>
                `).join('');
            } catch (e) {
                console.error('Marketplace load failed:', e);
            }
        }
        
        // üé® Portfolio Data
        const HARTO_COLLECTIONS = [
            { name: 'SATS', symbol: 'sats' },
            { name: 'The Golden Ratio', symbol: 'the-golden-ratio' },
            { name: 'FloraForms', symbol: 'floraforms-by-harto' },
            { name: 'Finestra', symbol: 'finestra' },
            { name: 'Exquisite', symbol: 'exquisite' },
            { name: 'Singularity', symbol: 'singularity-by-harto' },
            { name: 'Accumulation', symbol: 'accumulation-by-harto' },
            { name: 'Immutable Memories', symbol: 'immutable-memories' }
        ];
        
        let btcPriceUsd = 104000;
        
        async function loadPortfolioData() {
            const container = document.getElementById('portfolioGrid');
            
            try {
                // Get BTC price
                const priceRes = await fetch('https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=usd');
                if (priceRes.ok) {
                    const prices = await priceRes.json();
                    btcPriceUsd = prices.bitcoin?.usd || btcPriceUsd;
                }
                
                const portfolioData = [];
                
                for (const collection of HARTO_COLLECTIONS) {
                    try {
                        // Use our Vercel proxy
                        const res = await fetch(`/api/me-proxy?endpoint=stat&symbol=${collection.symbol}`);
                        if (res.ok) {
                            const stats = await res.json();
                            portfolioData.push({
                                name: collection.name,
                                symbol: collection.symbol,
                                supply: stats.supply || stats.totalSupply || '-',
                                floorPrice: stats.floorPrice ? (stats.floorPrice / 100000000) : 0,
                                change24h: stats.floorPriceChange1d || 0
                            });
                        } else {
                            portfolioData.push({
                                name: collection.name,
                                symbol: collection.symbol,
                                supply: '-',
                                floorPrice: 0,
                                change24h: 0
                            });
                        }
                        await new Promise(r => setTimeout(r, 150));
                    } catch (e) {
                        portfolioData.push({
                            name: collection.name,
                            symbol: collection.symbol,
                            supply: '-',
                            floorPrice: 0,
                            change24h: 0
                        });
                    }
                }
                
                const totalBtc = portfolioData.reduce((sum, c) => sum + c.floorPrice, 0);
                const totalUsd = totalBtc * btcPriceUsd;
                
                document.getElementById('portfolioTotalBtc').textContent = `${totalBtc.toFixed(2)} BTC`;
                document.getElementById('portfolioTotalUsd').textContent = `$${totalUsd.toLocaleString()}`;
                
                container.innerHTML = portfolioData.map(c => {
                    const floorUsd = c.floorPrice * btcPriceUsd;
                    const changeClass = c.change24h >= 0 ? 'positive' : 'negative';
                    const changeText = c.change24h !== 0 ? `${c.change24h > 0 ? '+' : ''}${c.change24h.toFixed(1)}%` : '';
                    
                    return `
                        <div class="portfolio-card">
                            <div class="portfolio-card-header">
                                <div>
                                    <div class="portfolio-collection-name">${c.name}</div>
                                    <div class="portfolio-supply">Supply: ${c.supply}</div>
                                </div>
                                ${changeText ? `<div class="portfolio-change ${changeClass}">${changeText}</div>` : ''}
                            </div>
                            <div class="portfolio-floor">${c.floorPrice > 0 ? c.floorPrice.toFixed(4) + ' BTC' : 'No floor'}</div>
                            <div class="portfolio-usd">${floorUsd > 0 ? '‚âà $' + floorUsd.toLocaleString() : '-'}</div>
                        </div>
                    `;
                }).join('');
                
                document.getElementById('portfolioLastUpdate').textContent = 
                    `Last updated: ${new Date().toLocaleTimeString('es-ES', { hour: '2-digit', minute: '2-digit' })}`;
                    
            } catch (e) {
                console.error('Portfolio load failed:', e);
                container.innerHTML = '<div class="error-state">‚ùå Failed to load portfolio</div>';
            }
        }
        
        // Initialize
        loadTickerData();
        loadTibbirData();
        loadMarketplaceData();
        loadPortfolioData();
        
        // Auto-refresh
        setInterval(loadTickerData, 60000);
        setInterval(loadTibbirData, 30000);
        setInterval(loadMarketplaceData, 300000);
        setInterval(loadPortfolioData, 300000);
    </script>
</body>
</html>
